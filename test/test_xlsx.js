const makecxlsx = require('../lib/makexlsx');

const filename = 'test_xlsx.xlsx';

const tables = [
    [
      { name: 'Дата', varname: 'date', id: '1' },
      { name: 'Значение', varname: 't03', id: '2' }
    ]
  ]

const data = [
    {
      startTs: 1732019160000,
      endTs: 1732019219000,
      t03: '96',
      date: '19.11.2024 15:26:59'
    },
    {
      startTs: 1732019220000,
      endTs: 1732019279000,
      t03: '155',
      date: '19.11.2024 15:27:59'
    },
    {
      startTs: 1732019280000,
      endTs: 1732019339000,
      t03: '215',
      date: '19.11.2024 15:28:59'
    },
    {
      startTs: 1732019340000,
      endTs: 1732019399000,
      t03: '275',
      date: '19.11.2024 15:29:59'
    },
    {
      startTs: 1732019400000,
      endTs: 1732019459000,
      t03: '335',
      date: '19.11.2024 15:30:59'
    },
    {
      startTs: 1732019460000,
      endTs: 1732019519000,
      t03: '395',
      date: '19.11.2024 15:31:59'
    },
    {
      startTs: 1732019520000,
      endTs: 1732019579000,
      t03: '455',
      date: '19.11.2024 15:32:59'
    },
    {
      startTs: 1732019580000,
      endTs: 1732019639000,
      t03: '515',
      date: '19.11.2024 15:33:59'
    },
    {
      startTs: 1732019640000,
      endTs: 1732019699000,
      t03: '575',
      date: '19.11.2024 15:34:59'
    },
    {
      startTs: 1732019700000,
      endTs: 1732019759000,
      t03: '635',
      date: '19.11.2024 15:35:59'
    },
    {
      startTs: 1732019760000,
      endTs: 1732019819000,
      t03: '695',
      date: '19.11.2024 15:36:59'
    },
    {
      startTs: 1732019820000,
      endTs: 1732019879000,
      t03: '754',
      date: '19.11.2024 15:37:59'
    },
    {
      startTs: 1732019880000,
      endTs: 1732019939000,
      t03: '807',
      date: '19.11.2024 15:38:59'
    },
    {
      startTs: 1732019940000,
      endTs: 1732019999000,
      t03: '65',
      date: '19.11.2024 15:39:59'
    },
    {
      startTs: 1732020000000,
      endTs: 1732020059000,
      t03: '124',
      date: '19.11.2024 15:40:59'
    },
    {
      startTs: 1732020060000,
      endTs: 1732020119000,
      t03: '184',
      date: '19.11.2024 15:41:59'
    },
    {
      startTs: 1732020120000,
      endTs: 1732020179000,
      t03: '244',
      date: '19.11.2024 15:42:59'
    },
    {
      startTs: 1732020180000,
      endTs: 1732020239000,
      t03: '304',
      date: '19.11.2024 15:43:59'
    },
    {
      startTs: 1732020240000,
      endTs: 1732020299000,
      t03: '364',
      date: '19.11.2024 15:44:59'
    },
    {
      startTs: 1732020300000,
      endTs: 1732020359000,
      t03: '424',
      date: '19.11.2024 15:45:59'
    },
    {
      startTs: 1732020360000,
      endTs: 1732020419000,
      t03: '484',
      date: '19.11.2024 15:46:59'
    },
    {
      startTs: 1732020420000,
      endTs: 1732020479000,
      t03: '544',
      date: '19.11.2024 15:47:59'
    },
    {
      startTs: 1732020480000,
      endTs: 1732020539000,
      t03: '604',
      date: '19.11.2024 15:48:59'
    },
    {
      startTs: 1732020540000,
      endTs: 1732020599000,
      t03: '634',
      date: '19.11.2024 15:49:59'
    },
    {
      startTs: 1732020600000,
      endTs: 1732020659000,
      t03: '87',
      date: '19.11.2024 15:50:59'
    },
    {
      startTs: 1732020660000,
      endTs: 1732020719000,
      t03: '147',
      date: '19.11.2024 15:51:59'
    },
    {
      startTs: 1732020720000,
      endTs: 1732020779000,
      t03: '206',
      date: '19.11.2024 15:52:59'
    },
    {
      startTs: 1732020780000,
      endTs: 1732020839000,
      t03: '266',
      date: '19.11.2024 15:53:59'
    },
    {
      startTs: 1732020840000,
      endTs: 1732020899000,
      t03: '326',
      date: '19.11.2024 15:54:59'
    },
    {
      startTs: 1732020900000,
      endTs: 1732020959000,
      t03: '386',
      date: '19.11.2024 15:55:59'
    },
    {
      startTs: 1732020960000,
      endTs: 1732021019000,
      t03: '446',
      date: '19.11.2024 15:56:59'
    },
    {
      startTs: 1732021020000,
      endTs: 1732021079000,
      t03: '506',
      date: '19.11.2024 15:57:59'
    },
    {
      startTs: 1732021080000,
      endTs: 1732021139000,
      t03: '566',
      date: '19.11.2024 15:58:59'
    },
    {
      startTs: 1732021140000,
      endTs: 1732021199000,
      t03: '626',
      date: '19.11.2024 15:59:59'
    },
    {
      startTs: 1732021200000,
      endTs: 1732021259000,
      t03: '686',
      date: '19.11.2024 16:00:59'
    },
    {
      startTs: 1732021260000,
      endTs: 1732021319000,
      t03: '745',
      date: '19.11.2024 16:01:59'
    },
    {
      startTs: 1732021320000,
      endTs: 1732021379000,
      t03: '805',
      date: '19.11.2024 16:02:59'
    },
    {
      startTs: 1732021380000,
      endTs: 1732021439000,
      t03: '865',
      date: '19.11.2024 16:03:59'
    },
    {
      startTs: 1732021440000,
      endTs: 1732021499000,
      t03: '925',
      date: '19.11.2024 16:04:59'
    },
    {
      startTs: 1732021500000,
      endTs: 1732021559000,
      t03: '965',
      date: '19.11.2024 16:05:59'
    },
    {
      startTs: 1732021560000,
      endTs: 1732021619000,
      t03: '78',
      date: '19.11.2024 16:06:59'
    },
    {
      startTs: 1732021620000,
      endTs: 1732021679000,
      t03: '98',
      date: '19.11.2024 16:07:59'
    },
    {
      startTs: 1732021680000,
      endTs: 1732021739000,
      t03: '97',
      date: '19.11.2024 16:08:59'
    },
    {
      startTs: 1732021740000,
      endTs: 1732021799000,
      t03: '157',
      date: '19.11.2024 16:09:59'
    },
    {
      startTs: 1732021800000,
      endTs: 1732021859000,
      t03: '217',
      date: '19.11.2024 16:10:59'
    },
    {
      startTs: 1732021860000,
      endTs: 1732021919000,
      t03: '277',
      date: '19.11.2024 16:11:59'
    },
    {
      startTs: 1732021920000,
      endTs: 1732021979000,
      t03: '337',
      date: '19.11.2024 16:12:59'
    },
    {
      startTs: 1732021980000,
      endTs: 1732022039000,
      t03: '397',
      date: '19.11.2024 16:13:59'
    },
    {
      startTs: 1732022040000,
      endTs: 1732022099000,
      t03: '457',
      date: '19.11.2024 16:14:59'
    },
    {
      startTs: 1732022100000,
      endTs: 1732022159000,
      t03: '516',
      date: '19.11.2024 16:15:59'
    },
    {
      startTs: 1732022160000,
      endTs: 1732022219000,
      t03: '576',
      date: '19.11.2024 16:16:59'
    },
    {
      startTs: 1732022220000,
      endTs: 1732022279000,
      t03: '636',
      date: '19.11.2024 16:17:59'
    },
    {
      startTs: 1732022280000,
      endTs: 1732022339000,
      t03: '696',
      date: '19.11.2024 16:18:59'
    },
    {
      startTs: 1732022340000,
      endTs: 1732022399000,
      t03: '756',
      date: '19.11.2024 16:19:59'
    },
    {
      startTs: 1732022400000,
      endTs: 1732022459000,
      t03: '816',
      date: '19.11.2024 16:20:59'
    },
    {
      startTs: 1732022460000,
      endTs: 1732022519000,
      t03: '876',
      date: '19.11.2024 16:21:59'
    },
    {
      startTs: 1732022520000,
      endTs: 1732022579000,
      t03: '936',
      date: '19.11.2024 16:22:59'
    },
    {
      startTs: 1732022580000,
      endTs: 1732022639000,
      t03: '996',
      date: '19.11.2024 16:23:59'
    },
    {
      startTs: 1732022640000,
      endTs: 1732022699000,
      t03: '1055',
      date: '19.11.2024 16:24:59'
    },
    {
      startTs: 1732022700000,
      endTs: 1732022759000,
      t03: '1115',
      date: '19.11.2024 16:25:59'
    },
    {
      startTs: 1732022760000,
      endTs: 1732022819000,
      t03: '1141',
      date: '19.11.2024 16:26:59'
    },
    {
      startTs: 1732022820000,
      endTs: 1732022879000,
      t03: '92',
      date: '19.11.2024 16:27:59'
    },
    {
      startTs: 1732022880000,
      endTs: 1732022939000,
      t03: '152',
      date: '19.11.2024 16:28:59'
    },
    {
      startTs: 1732022940000,
      endTs: 1732022999000,
      t03: '176',
      date: '19.11.2024 16:29:59'
    }
]

const mes = {};

async function tryXlsx() {
    try {
       await makecxlsx(tables, data, filename, mes)
       console.log('Файл успешно создан!')
    } catch(err) {
        console.log(err.message)
    }
}

tryXlsx()